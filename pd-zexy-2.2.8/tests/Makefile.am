AUTOMAKE_OPTIONS = foreign

@VALGRIND_CHECK_RULES@

EXTRA_DIST = \
	README.txt \
	run1.sh \
	run1.pd \
	runtests.sh \
	runtests.bat \
	runtests_nogui.pd \
	runtests.pd \
	testunit.pd \
	$(nada)

EXTRA_DIST += \
	msgfile/msgfile.txt \
	msgfile/CR.txt \
	testtests/README.txt \
	$(TESTS)

TEST_EXTENSIONS = .pd
PD_LOG_COMPILER = $(srcdir)/run1.sh
#AM_PD_LOG_FLAGS = -v

AM_TESTS_ENVIRONMENT = SRCDIR=$(top_srcdir)
AM_TESTS_ENVIRONMENT+= BUILDDIR=$(top_builddir)
AM_TESTS_ENVIRONMENT+= LIBDIR=$(top_builddir)/src/.libs
AM_TESTS_ENVIRONMENT+= TESTDIR=$(srcdir)
AM_TESTS_ENVIRONMENT+= VALGRIND='$(VALGRIND)'



.PHONY: update
update: Makefile.am
	sed -e '0,/@TESTS@/!{0,/@TESTS@/!{/@TESTS@/{N;q}}}' -i $<
	find */ -type f -name "*.pd" | sort | sed -e 's|^|	|' -e 's|$$| \\|' >> $<
	echo '	$$(nada)' >> $<

XFAIL_TESTS = \
	testtests/fail_noresult.pd \
	testtests/fail.pd \
	testtests/fail_wait0.pd \
	testtests/fail_wait10.pd \
	$(nada)

TESTS =
if LIBRARY
TESTS += \
	eq~/dualnoise.pd \
	eq~/singlenoise.pd \
	gt~/dualnoise.pd \
	lt~/dualnoise.pd \
	$(nada)
endif LIBRARY

# everything below the line with @TESTS@ is autogenerated
# DO NOT EDIT!!! instead run 'make Makefile.am'
#### @TESTS@ ####
TESTS += \
	absgn~/abs.pd \
	absgn~/sgn.pd \
	abs~/simple.pd \
	and~/dualnoise.pd \
	and~/singlenoise.pd \
	gt~/singlenoise.pd \
	help-msg/0x260x260x7e.pd \
	help-msg/0x2e.pd \
	help-msg/0x3c0x7e.pd \
	help-msg/0x3d0x3d0x7e.pd \
	help-msg/0x3e0x7e.pd \
	help-msg/0x7c0x7c0x7e.pd \
	help-msg/a2l.pd \
	help-msg/absgn~.pd \
	help-msg/abs~.pd \
	help-msg/atoi.pd \
	help-msg/avg~.pd \
	help-msg/blockmirror~.pd \
	help-msg/blockswap~.pd \
	help-msg/date.pd \
	help-msg/demultiplex~.pd \
	help-msg/demultiplex.pd \
	help-msg/dfreq~.pd \
	help-msg/dirac~.pd \
	help-msg/drip.pd \
	help-msg/envrms~.pd \
	help-msg/fifop.pd \
	help-msg/glue.pd \
	help-msg/index.pd \
	help-msg/length.pd \
	help-msg/lifop.pd \
	help-msg/limiter~.pd \
	help-msg/list2int.pd \
	help-msg/list2symbol.pd \
	help-msg/lister.pd \
	help-msg/lpt.pd \
	help-msg/makesymbol.pd \
	help-msg/mavg.pd \
	help-msg/minmax.pd \
	help-msg/msgfile.pd \
	help-msg/multiline~.pd \
	help-msg/multiplex~.pd \
	help-msg/multiplex.pd \
	help-msg/niagara.pd \
	help-msg/noish~.pd \
	help-msg/noisi~.pd \
	help-msg/operating_system.pd \
	help-msg/packel.pd \
	help-msg/pack~.pd \
	help-msg/pdf~.pd \
	help-msg/prime.pd \
	help-msg/quantize~.pd \
	help-msg/regex.pd \
	help-msg/relay.pd \
	help-msg/repack.pd \
	help-msg/repeat.pd \
	help-msg/sfplay.pd \
	help-msg/sfrecord.pd \
	help-msg/sgn~.pd \
	help-msg/sigzero~.pd \
	help-msg/sort.pd \
	help-msg/step~.pd \
	help-msg/strcmp.pd \
	help-msg/sum.pd \
	help-msg/swap~.pd \
	help-msg/symbol2list.pd \
	help-msg/tabdump.pd \
	help-msg/tabminmax.pd \
	help-msg/tabset.pd \
	help-msg/tavg~.pd \
	help-msg/time.pd \
	help-msg/unpack~.pd \
	help-msg/urn.pd \
	help-msg/wrap.pd \
	help-msg/zexy_.pd \
	help-msg/z~.pd \
	l2s/argument.pd \
	l2s/delimiter.pd \
	list2lists/negativelength.pd \
	lister/inline2.pd \
	lister/inline.pd \
	lt~/singlenoise.pd \
	msgfile/add2.pd \
	msgfile/empty_at_end.pd \
	msgfile/emptyreplace.pd \
	msgfile/loadingCR.pd \
	msgfile/loading.pd \
	msgfile/prev_from_end.pd \
	msgfile/reentrant.pd \
	or~/dualnoise.pd \
	or~/singlenoise.pd \
	relay/floatfloat.pd \
	repeat/noargs.pd \
	s2l/numsymbols.pd \
	sgn~/simple.pd \
	testtests/fail_noresult.pd \
	testtests/fail.pd \
	testtests/fail_wait0.pd \
	testtests/fail_wait10.pd \
	testtests/pass.pd \
	testtests/pass_wait0.pd \
	testtests/pass_wait10.pd \
	$(nada)
